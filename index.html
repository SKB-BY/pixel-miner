<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Pixel Miner</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #0f0c29;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      overflow: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    #game {
      text-align: center;
      max-width: 500px;
      padding: 20px;
    }
    #energy, #cycles, #shards {
      font-size: 1.4em;
      margin: 10px 0;
    }
    #mineBtn {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background: linear-gradient(135deg, #6a11cb, #2575fc);
      color: white;
      font-size: 1.2em;
      border: none;
      margin: 20px 0;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
    #upgradeBtn, #cycleBtn {
      padding: 10px 20px;
      margin: 5px;
      background: #ff416c;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    #donateBtn {
      margin-top: 20px;
      padding: 8px 16px;
      background: #ffb300;
      color: #000;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="game">
    <h2>‚ö° Pixel Miner</h2>
    <div id="energy">–≠–Ω–µ—Ä–≥–∏—è: <span id="energyVal">0</span></div>
    <div id="cycles">–¶–∏–∫–ª–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ: <span id="cycleCount">0</span></div>
    <div id="shards">–û—Å–∫–æ–ª–∫–æ–≤ –ê—Å–∫–µ–Ω–∑–∏–∏: <span id="shardCount">0</span></div>
    <button id="mineBtn">–¢–ê–ü–ù–ò!</button>
    <br>
    <button id="upgradeBtn">–£–ª—É—á—à–∏—Ç—å –¥–æ–±—ã—á—É (+1) - 10 –≠–Ω.</button>
    <button id="cycleBtn">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ü–∏–∫–ª –æ—á–∏—â–µ–Ω–∏—è</button>
    <br>
    <button id="donateBtn">üíé –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å (TON)</button>
  </div>

  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
    const tg = window.Telegram.WebApp;
    tg.expand();
    tg.ready();

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    let saveData = JSON.parse(localStorage.getItem('pixelMinerSave')) || {
      energy: 0,
      shards: 0,
      cycles: 0,
      tapPower: 1,
      autoClick: 0
    };

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
    const energyEl = document.getElementById('energyVal');
    const shardEl = document.getElementById('shardCount');
    const cycleEl = document.getElementById('cycleCount');
    const mineBtn = document.getElementById('mineBtn');
    const upgradeBtn = document.getElementById('upgradeBtn');
    const cycleBtn = document.getElementById('cycleBtn');
    const donateBtn = document.getElementById('donateBtn');

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
    function updateUI() {
      energyEl.textContent = Math.floor(saveData.energy);
      shardEl.textContent = saveData.shards;
      cycleEl.textContent = saveData.cycles;
    }

    // –î–æ–±—ã—á–∞ —ç–Ω–µ—Ä–≥–∏–∏
    mineBtn.addEventListener('click', () => {
      saveData.energy += saveData.tapPower;
      updateUI();
      saveGame();
    });

    // –£–ª—É—á—à–µ–Ω–∏–µ
    upgradeBtn.addEventListener('click', () => {
      if (saveData.energy >= 10) {
        saveData.energy -= 10;
        saveData.tapPower += 1;
        updateUI();
        saveGame();
      }
    });

    // –¶–∏–∫–ª –æ—á–∏—â–µ–Ω–∏—è (–∑–∞–º–∫–Ω—É—Ç—ã–π —Ü–∏–∫–ª)
    cycleBtn.addEventListener('click', () => {
      if (saveData.energy < 1) return;
      const shardsEarned = Math.max(1, Math.floor(saveData.tapPower / 2));
      saveData.shards += shardsEarned;
      saveData.energy = 0; // –ø–æ—á—Ç–∏ –≤—Å—ë —Ç–µ—Ä—è–µ—Ç—Å—è
      saveData.cycles += 1;
      alert(`–¶–∏–∫–ª –∑–∞–≤–µ—Ä—à—ë–Ω! –ü–æ–ª—É—á–µ–Ω–æ ${shardsEarned} –æ—Å–∫–æ–ª–∫–æ–≤.`);
      updateUI();
      saveGame();
    });

    // –î–æ–Ω–∞—Ç —á–µ—Ä–µ–∑ TON (Telegram Stars / TON Connect)
    donateBtn.addEventListener('click', () => {
      if (typeof tg.openInvoice === 'function') {
        // –ü—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ –≤—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ Stars –≤ BotFather
        tg.openInvoice('https://your-bot-payment-link.com'); // ‚Üê –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
      } else {
        alert('–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–µ—Ä–µ–∑ TON —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç! –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏.');
        // –í –±—É–¥—É—â–µ–º: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å @wallet –∏–ª–∏ TON Connect
      }
    });

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    function saveGame() {
      localStorage.setItem('pixelMinerSave', JSON.stringify(saveData));
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    updateUI();
  </script>
</body>
</html>
